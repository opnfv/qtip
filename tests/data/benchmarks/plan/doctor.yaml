name: doctor performance profiling
description: create performance profile for OPNFV doctor notification time
info:
  facility: local
  engineer: local
config:
  collectors:
    - type: logfile
      logs:
        - filename: doctor_consumer.log
          # 2016-12-28 03:16:05,630 consumer.py 26 INFO   doctor consumer notified at 1482894965.63
          grep:
            - regex: 'doctor consumer notified at \d+(\.\d+)?$'
              group: consumer_notified
        - filename: doctor_inspector.log
          # 2016-12-28 03:16:05,299 inspector.py 76 INFO   event posted at 1482894965.3
          # 2016-12-28 03:16:05,299 inspector.py 56 INFO   doctor mark vm(<Server: doctor_vm1>) error at 1482894965.3
          # 2016-12-28 03:16:05,506 inspector.py 66 INFO   doctor mark host(overcloud-novacompute-1.ool-virtual1) down at 1482894965.51
          grep:
            - regex: 'event posted at \d+(\.\d+)?$'
              group: event_posted
            - regex: 'doctor mark vm\(.*\) error at \d+(\.\d+)?$'
              group: VM_error
            - regex: 'doctor mark host\(.*\) down at \d+(\.\d+)?$'
              group: host_down
        - filename: disable_network.log
          # doctor set host down at 1482894965.164096803
          grep:
            - regex: 'doctor set host down at \d+(\.\d+)?$'
              group: network_disabled
  reporters:
    - type: console
      # transform collected data into timeline
      transformer: timeline
QPIs:
  - fake_qpi.yaml
